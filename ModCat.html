<html>
<head>
    <title>PRS MODCAT Decoder</title>
    <script src="MODCAT_data.js" type="text/javascript"></script>
    <link href="styles.css" rel="stylesheet">

    <script Language='JavaScript'>

        let modelCode, topWoodCode, fretsCode, topSpecCode;
        let topGradeCode, neckWoodCode, neckCarveCode, fingerboardCode;
        let inlayCode, bridgeCode, colorCode, hardwareCode;
        let treblepuCode, middlepuCode, basspuCode, elecCode;
        let model, topWood, frets, topSpec;
        let topGrade, neckWood, neckCarve, fingerboard;
        let inlay, bridge, color, hardware;
        let treblepu, middlepu, basspu, elec;


        function decodeMODCAT(modcat){
            let inMODCAT = modcat.replace(/\s+/g,"")
            inMODCAT = inMODCAT.replace(/-/g, "_")
            inMODCAT = inMODCAT.replace(/\^/g, "_")
            inMODCAT = inMODCAT.trim()
            inMODCAT = inMODCAT.toUpperCase()
            setCodeVals(inMODCAT)
            getMODCATvals()
            setFieldVals()
        }

        function getMODCATvals(){
            model = getMODCATstring("model", "Model")
            topWood = getMODCATstring("topWood", "Top Wood")
            frets = getMODCATstring("frets", "Frets")
            topSpec = getMODCATstring("topSpec", "Top Spec")
            topGrade = getMODCATstring("topGrade", "Top Grade")
            neckWood = getMODCATstring("neckWood", "Neck Wood")
            neckCarve = getMODCATstring("neckCarve", "Neck Carve")
            fingerboard = getMODCATstring("fingerboard", "Fingerboard Wood")
            inlay = getMODCATstring("inlay", "Inlay")
            bridge = getMODCATstring("bridge", "Bridge")
            color = getMODCATstring("color", "Color")
            hardware = getMODCATstring("hardware", "Hardware")
            treblepu = getMODCATstring("treblepu", "Treble Pickup")
            middlepu = getMODCATstring("middlepu", "Middle Pickup")
            basspu = getMODCATstring("basspu", "Bass Pickup")
            elec = getMODCATstring("elec", "Electronics")
        }

        function getMODCATstring(spec, specName){
            let returnString
            let specCode = eval(spec + "Code")
            let modcatKey = spec + specCode

            try{
                returnString = eval(modcatKey);
            } catch(err){
                returnString = "Could not find " + specName + " '" + specCode + "'"
            }

            return returnString;
        }

        function setCodeVals(m){
            let arr = m.split("")
            modelCode = arr[0] + arr[1]
            topWoodCode = arr[2]
            fretsCode = arr[3]
            topSpecCode = arr[4]
            topGradeCode = arr[5]
            neckWoodCode = arr[6]
            neckCarveCode = arr[7]
            fingerboardCode = arr[8]
            inlayCode = arr[9]
            bridgeCode = arr[10]
            hardwareCode = arr[15]
            treblepuCode = arr[16]
            middlepuCode = arr[17]
            basspuCode = arr[18]
            elecCode = arr[19]

            // At least one color code has 3 characters, so need to accommodate that.
            tempColor = arr[11] + arr[12] + arr[13] + arr[14]
            colorCode = tempColor.replace(/_/g, "")
        }

        function setFieldVals(){
            setVal("modelField", model)
            setVal("topWoodField", topWood)
            setVal("fretsField", frets)
            setVal("topSpecField", topSpec)
            setVal("topGradeField", topGrade)
            setVal("neckWoodField", neckWood)
            setVal("neckCarveField", neckCarve)
            setVal("fingerboardField", fingerboard)
            setVal("inlayField", inlay)
            setVal("bridgeField", bridge)
            setVal("colorField", color)
            setVal("hardwareField", hardware)
            setVal("treblepuField", treblepu)
            setVal("middlepuField", middlepu)
            setVal("basspuField", basspu)
            setVal("elecField", elec)
        }

        function setVal(field, value){
            document.getElementById(field).innerHTML = value
        }

    </script>

</head>

<body>

<div align="center" id="mainDiv">
    <IMG SRC="guitaroutline.jpg">
    <h1>PRS MODCAT DECODER</h1>

    Enter MODCAT: <input type="text" size="30" id="theMODCAT">
    <br><br>
    <input type="button" value="Decode MODCAT" onClick="javascript:decodeMODCAT(document.getElementById('theMODCAT').value)">

    <br><br>
    <table id="dataTable">
        <tr><td class="label">Model: </td><td align="left"><span id='modelField'></span></td></tr>
        <tr><td class="label" align="right">Top Wood: </td><td align="left"><span id='topWoodField'></span></td></tr>
        <tr><td class="label" align="right">Frets: </td><td align="left"><span id='fretsField'></span></td></tr>
        <tr><td class="label" align="right">Top Spec: </td><td align="left"><span id='topSpecField'></span></td></tr>
        <tr><td class="label" align="right">Top Grade: </td><td align="left"><span id='topGradeField'></span></td></tr>
        <tr><td class="label" align="right">Neck Wood: </td><td align="left"><span id='neckWoodField'></span></td></tr>
        <tr><td class="label" align="right">Neck Carve: </td><td align="left"><span id='neckCarveField'></span></td></tr>
        <tr><td class="label" align="right">Fingerboard Wood: </td><td align="left"><span id='fingerboardField'></span></td></tr>
        <tr><td class="label" align="right">Inlay: </td><td align="left"><span id='inlayField'></span></td></tr>
        <tr><td class="label" align="right">Bridge: </td><td align="left"><span id='bridgeField'></span></td></tr>
        <tr><td class="label" align="right">Color: </td><td align="left"><span id='colorField'></span></td></tr>
        <tr><td class="label" align="right">Hardware: </td><td align="left"><span id='hardwareField'></span></td></tr>
        <tr><td class="label" align="right">Treble Pickup: </td><td align="left"><span id='treblepuField'></span><br></td></tr>
        <tr><td class="label" align="right">Middle Pickup: </td><td align="left"><span id='middlepuField'></span></td></tr>
        <tr><td class="label" align="right">Bass Pickup: </td><td align="left"><span id='basspuField'></span></td></tr>
        <tr><td class="label" align="right">Electronics: </td><td align="left"><span id='elecField'></span></td></tr>

    </table>
    <p></p>
    <p>A sample MODCAT:  SLM2FAHFIET_FR_HB-BS </p>
    <p>Original Javascript courtesy TFC</p>
</div>

</body>
</html>
